---
import { PortableText } from "astro-portabletext";
import RichTextHeading from "@/components/elements/Heading/RichTextHeading.astro";
import Cta from "@/components/elements/Cta/Cta.astro";
import type { Stats } from "@/lib/schemas/page";
import type { SemanticLevel } from "@/lib/types";
import Section from "@/components/elements/Section/Section.astro";

interface Props {
  stats: Stats;
  lazyLoad?: boolean;
  semanticLevel?: SemanticLevel;
}

const { stats, lazyLoad = true, semanticLevel = "h2" } = Astro.props;

const { eyebrow, title, subhead, body, cta, statsItems = [] } = stats;
---

<Section class="stats">
  <div class="stats__container">
    <div class="stats__header">
      {eyebrow && <p class="stats__eyebrow">{eyebrow}</p>}

      {
        title?.length > 0 && (
          <div class="stats__title">
            <RichTextHeading text={title} semanticLevel={semanticLevel} />
          </div>
        )
      }

      {
        subhead?.length > 0 && (
          <div class="stats__subhead">
            <PortableText value={subhead} />
          </div>
        )
      }

      {
        body?.length > 0 && (
          <div class="stats__body">
            <PortableText value={body} />
          </div>
        )
      }

      {
        cta && cta.length > 0 && (
          <div class="stats__cta">
            <Cta cta={cta} />
          </div>
        )
      }
    </div>

    {
      statsItems && statsItems.length > 0 && (
        <div class="stats__grid">
          {statsItems.map((item) => (
            <div class="stats__item">
              <span class="stats__value">{item.value}</span>
              <span class="stats__label">{item.label}</span>
            </div>
          ))}
        </div>
      )
    }
  </div>
</Section>

<style>
  .stats {
    background-color: #ffffff;
    color: #333333;
  }

  .stats__container {
    max-width: 1216px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1px;
    background-color: #e5e5e5;
  }

  .stats__header {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    padding: 2rem;
    background-color: #ffffff;
  }

  .stats__eyebrow {
    font-size: 0.875rem;
    font-weight: 300;
    color: #5f5f5f;
    margin: 0;
  }

  .stats__title {
    margin: 0;
  }

  .stats__title :global(h1),
  .stats__title :global(h2) {
    font-size: 2.25rem;
    font-weight: 300;
    line-height: 1.25;
    letter-spacing: -0.03em;
    margin: 0;
  }

  .stats__subhead {
    font-size: 2.25rem;
    font-weight: 300;
    line-height: 1.25;
    letter-spacing: -0.01em;
  }

  .stats__subhead :global(p) {
    margin: 0;
  }

  .stats__body {
    font-size: 1rem;
    font-weight: 300;
    line-height: 1.5;
  }

  .stats__body :global(p) {
    margin: 0 0 1rem 0;
  }

  .stats__body :global(p:last-child) {
    margin-bottom: 0;
  }

  .stats__cta {
    display: flex;
    gap: 1.5rem;
    align-items: center;
    flex-wrap: wrap;
    margin-top: 0.5rem;
  }

  .stats__grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    background-color: #e5e5e5;
    gap: 1px;
  }

  .stats__item {
    display: flex;
    flex-direction: column;
    gap: 0;
    padding: 2rem 1rem;
    background-color: #ffffff;
  }

  .stats__value {
    font-size: 4.5rem;
    font-weight: 300;
    line-height: 1;
    letter-spacing: -0.02em;
    font-feature-settings: "tnum";
  }

  .stats__label {
    font-size: 1rem;
    font-weight: 300;
    line-height: 1.5;
    color: #333333;
    max-width: 17rem;
  }

  /* Responsive styles */
  @media (max-width: 968px) {
    .stats__container {
      grid-template-columns: 1fr;
    }

    .stats__header {
      border-bottom: 1px solid #e5e5e5;
    }

    .stats__title :global(h1),
    .stats__title :global(h2) {
      font-size: 1.875rem;
    }

    .stats__subhead {
      font-size: 1.875rem;
    }
  }

  @media (max-width: 480px) {
    .stats__value {
      font-size: 3.5rem;
    }
  }
</style>
